
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/example_mock_data.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_example_mock_data.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_example_mock_data.py:


Obtain risk scores and alleles
==============================

This example uses a mock dataset file with genotic information hosted in GIN.
The alleles are extracted from the BGEN files and a risk score is calculated

.. include:: ../links.inc

.. GENERATED FROM PYTHON SOURCE LINES 10-20

.. code-block:: default

    # # Authors: Oscar Portoles <o.portoles@fz-juelich.de>
    #            Federico Raimondo <f.raimondo@fz-juelich.de>
    #
    # License: AGPL

    from tempfile import mkdtemp
    import shutil
    from hipsnp.hipsnp import genotype_from_datalad
    from hipsnp.utils import configure_logging


.. GENERATED FROM PYTHON SOURCE LINES 21-22

Set the logging level to info to see extra information

.. GENERATED FROM PYTHON SOURCE LINES 22-24

.. code-block:: default

    configure_logging(level='INFO')


.. GENERATED FROM PYTHON SOURCE LINES 25-27

Get a temporary directory to work. Use another directory if you want to
keep the data.

.. GENERATED FROM PYTHON SOURCE LINES 27-29

.. code-block:: default

    workdir = mkdtemp()


.. GENERATED FROM PYTHON SOURCE LINES 30-32

Obtain a genotype from a datalad dataset. We can use the same directory
as work and data directory.

.. GENERATED FROM PYTHON SOURCE LINES 32-35

.. code-block:: default

    source = 'https://gin.g-node.org/juaml/datalad-example-bgen'
    genotype = genotype_from_datalad(source, workdir=workdir, datadir=workdir)


.. GENERATED FROM PYTHON SOURCE LINES 36-37

Now we are ready to obtain the alleles of each rsid and sample in the data

.. GENERATED FROM PYTHON SOURCE LINES 37-42

.. code-block:: default

    gen_allele, gen_012 = genotype.alleles()

    # For example, we can count the number of times that an allele appears
    gen_allele.loc['RSID_2'].value_counts()


.. GENERATED FROM PYTHON SOURCE LINES 43-46

To compute a poligenetic risk score we need a file or a pandas dataframe with
the weights associated to each allele and RSID. We can retrieve one from
https://www.pgscatalog.org/.

.. GENERATED FROM PYTHON SOURCE LINES 46-57

.. code-block:: default


    # In this case we use a weights file generated for this mock datasets.
    path_to_weights = './data/weights_all.csv'

    # Now we can obtain the risk score for each rsids given the samples on the
    # dataset and the dosage (amount of the effect allele) of each rsids and sample
    dosage, risk = genotype.riskscore(weights=path_to_weights)

    # Then, for example, we can visualize the risk score of each sample
    risk.plot()


.. GENERATED FROM PYTHON SOURCE LINES 58-59

Since we used a temporary directory, we need to delete it

.. GENERATED FROM PYTHON SOURCE LINES 59-60

.. code-block:: default

    shutil.rmtree(workdir)


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.000 seconds)


.. _sphx_glr_download_auto_examples_example_mock_data.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: example_mock_data.py <example_mock_data.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: example_mock_data.ipynb <example_mock_data.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
